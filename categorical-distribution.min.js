/*! categorical-distribution - v3.0.0 - 2014-04-06
 * https://github.com/axelpale/categorical-distribution-js
 *
 * Copyright (c) 2014 Akseli Palen <akseli.palen@gmail.com>;
 * Licensed under the MIT license */


!function(a){"use strict";var b={},c=function(a){return"[object Array]"===Object.prototype.toString.call(a)},d=function(a){return"string"==typeof a||"number"==typeof a?[a]:c(a)?a:[]},e=function(a,b){return Math.random()*(b-a)+a},f=function(a,b,c){var d,e,f,g=[];if("number"!=typeof a&&(a=1),1>a)return g;for(g.push(1-Math.pow(Math.random(),1/a)),d=1;a>d;d+=1)e=g[g.length-1],f=1-Math.pow(Math.random(),1/(a-d)),g.push(e+(1-e)*f);for(d=0;a>d;d+=1)g[d]=b+(c-b)*g[d];return g},g=function(a){for(var b,c,d=a.length;d>0;)c=Math.floor(Math.random()*d),d-=1,b=a[d],a[d]=a[c],a[c]=b;return a};b.util={isArray:c,toArray:d,randomFromInterval:e,randomOrderedSetFromInterval:f},b.CategoricalDistribution=function(){var a={},b=function(a,b){var c,d,e,f,g,h,i;if(c=a.state,d=c.indices[b],e=c.weights[b],g=d===c.order.length-1,h=0===d,f=g?!0:h?!1:c.weights[c.order[d-1]]<e?!0:!1)for(;0!==d&&c.weights[c.order[d-1]]<=e;)i=c.order[d-1],c.order[d]=i,c.order[d-1]=b,c.indices[i]=d,d-=1;else for(;d!==c.order.length-1&&c.weights[c.order[d+1]]>e;)i=c.order[d+1],c.order[d]=i,c.order[d+1]=b,c.indices[i]=d,d+=1;c.indices[b]=d},c=function(a,b){var c,d,e,f,g,h;for(c=a.state,d=c.order.length,e=Math.max(0,c.weightsSum-b),f=e/c.weightsSum,g=0;d>g;g+=1)h=c.order[g],c.weights[h]*=f;c.weightsSum=e},d=function(a,b){var c,d,f,g,h=[],i=a.state;if(0===i.order.length||0>=b)return h;for(d=0;b>d;d+=1)for(c=e(0,i.weightsSum),g=0,f=0;f<i.order.length;f+=1)if(g+=i.weights[i.order[f]],g>c){h.push(i.order[f]);break}return h},h=function(a,b){var c,d,e,g,h,i=[],j=a.state;if(0===j.order.length||0>=b)return i;for(c=f(b,0,j.weightsSum),d=0,e=j.weights[j.order[d]],g=0;b>g;g+=1)if(h=c[g],e>h)i.push(j.order[d]);else{do d+=1,e+=j.weights[j.order[d]];while(h>=e);i.push(j.order[d])}return i},i={name:"NotAnArrayException",message:"Parameter is required to be an array"},j=function(a){this.state={weights:{},weightsSum:0,memorySize:1/0,order:[],indices:{}},this.memorySize(a)};return a.create=function(a){return new j(a)},j.prototype.prob=function(a){var b,c,d,e=[],f=this.state;if("string"==typeof a)throw i;for("undefined"==typeof a&&(a=f.order),b=0;b<a.length;b+=1)c=a[b],f.weights.hasOwnProperty(c)?(d=f.weights[c]/f.weightsSum,e.push(d)):e.push(0);return e},j.prototype.head=function(a){var b=this.state;return"number"!=typeof a&&(a=0),a=Math.min(a,b.order.length),a>0?b.order.slice(0,a):0===a?b.order.slice(0):[]},j.prototype.peak=function(a){var b,c,d,e=this.state;if(0===e.order.length)return[];for(c=e.weights[e.order[0]],d=c-c*a,b=1;b<e.order.length&&!(d>e.weights[e.order[b]]);b+=1);return e.order.slice(0,b)},j.prototype.subset=function(a){var b,c,d,e,f=this.state;for(d=new j(f.memorySize),e=d.state,b=0;b<a.length;b+=1)c=a[b],f.weights.hasOwnProperty(c)&&(e.weights[c]=f.weights[c],e.weightsSum+=f.weights[c]);for(b=0;b<f.order.length;b+=1)c=f.order[b],e.weights.hasOwnProperty(c)&&(e.order.push(c),e.indices[c]=e.order.length-1);return d},j.prototype.rank=function(a){var b,c,d=[],e=this.state;if("string"==typeof a)throw i;for("undefined"==typeof a&&(a=e.order),b=0;b<a.length;b+=1)c=a[b],d.push(e.indices.hasOwnProperty(c)?e.indices[c]:1/0);return d},j.prototype.each=function(a,b){var c,d,e,f,g=this.state,h=g.order.length;for(c=0;h>c;c+=1)d=g.order[c],e=g.weights[d]/g.weightsSum,f=g.indices[d],a.call(b,d,e,f);return this},j.prototype.map=function(a,b){var c=[];return this.each(function(d,e,f){c.push(a.call(b,d,e,f))}),c},j.prototype.sample=function(a,b){var c,e,f=this.state;return"number"!=typeof a&&(a=1),"boolean"!=typeof b&&(b=!1),b?e=h(this,a):(c=f.order.length>30,e=c?g(h(this,a)):d(this,a)),e},j.prototype.size=function(){return this.state.weightsSum},j.prototype.numCategories=function(){return this.state.order.length},j.prototype.dump=function(){var a,b,c,d=this.state,e=[];for(a=0;a<d.order.length;a+=1)b=d.order[a],c=d.weights[b],e.push(b),e.push(c);return e.push(1/0===d.memorySize?null:d.memorySize),e},j.prototype.copy=function(){var a=new j;return a.load(this.dump()),a},j.prototype.print=function(a){var b,c,d,e,f,g=this.state,h=0,i=g.order.length,j="";for("number"!=typeof a&&(a=2),a=Math.max(Math.min(a,10),0),e=this.prob(g.order),b=0;i>b;b+=1)c=g.order[b],h=Math.max(h,c.length);for(b=0;i>b;b+=1){for(c=g.order[b],d=e[b],f=c.length;h>f;f+=1)c+=" ";j+=c+" "+d.toFixed(a)+"\n"}return j},j.prototype.learn=function(a){var d,e,f=this.state;if(0===f.memorySize)return this;for(d=0;d<a.length;d+=1)f.weightsSum+1>f.memorySize&&c(this,1),e=a[d],f.weights.hasOwnProperty(e)?f.weights[e]+=1:(f.weights[e]=1,f.order.push(e),f.indices[e]=f.order.length-1),f.weightsSum+=1,b(this,e);return this},j.prototype.unlearn=function(a){var c,d,e,f,g;for(c=this.state,d=0;d<a.length;d+=1)e=a[d],c.weights.hasOwnProperty(e)&&c.weights[e]>0&&(f=Math.max(0,c.weights[e]-1),g=f-c.weights[e],c.weights[e]=f,c.weightsSum+=g,b(this,e));return this},j.prototype.memorySize=function(a){var b,d;return b=this.state,"undefined"==typeof a?b.memorySize:("number"!=typeof a&&(a=1/0),a=Math.max(0,a),d=b.weightsSum-a,d>0&&c(this,d),void(b.memorySize=a))},j.prototype.load=function(a){var b,c,d,e;for(e={weights:{},weightsSum:0,memorySize:1/0,order:[],indices:{}},b=0;b<a.length-2;b+=2)c=a[b],d=a[b+1],e.weights[c]=d,e.weightsSum+=d,e.order.push(c),e.indices[c]=e.order.length-1;return this.state=e,this.memorySize(a[b]),this},a}(),b.version="3.0.0",b.CategoricalDistribution.util=b.util,"object"==typeof module&&"object"==typeof module.exports?module.exports=b.CategoricalDistribution:a.CategoricalDistribution=b.CategoricalDistribution}(this);
//# sourceMappingURL=categorical-distribution.min.map