/*! categorical-distribution - v2.0.0 - 2014-04-03
 * https://github.com/axelpale/categorical-distribution-js
 *
 * Copyright (c) 2014 Akseli Palen <akseli.palen@gmail.com>;
 * Licensed under the MIT license */


!function(a){"use strict";var b={},c=function(a){return"[object Array]"===Object.prototype.toString.call(a)},d=function(a){return"string"==typeof a||"number"==typeof a?[a]:c(a)?a:[]},e=function(a,b){return Math.random()*(b-a)+a},f=function(a,b,c){var d,e,f,g=[];if("number"!=typeof a&&(a=1),1>a)return g;for(g.push(1-Math.pow(Math.random(),1/a)),d=1;a>d;d+=1)e=g[g.length-1],f=1-Math.pow(Math.random(),1/(a-d)),g.push(e+(1-e)*f);for(d=0;a>d;d+=1)g[d]=b+(c-b)*g[d];return g},g=function(a){for(var b,c,d=a.length;d>0;)c=Math.floor(Math.random()*d),d-=1,b=a[d],a[d]=a[c],a[c]=b;return a};b.util={isArray:c,toArray:d,randomFromInterval:e,randomOrderedSetFromInterval:f},b.CategoricalDistribution=function(){var a={},b=function(a,b){var c,d,e,f,g,h,i;if(c=a.state,d=c.indices[b],e=c.counters[b],g=d===c.order.length-1,h=0===d,f=g?!0:h?!1:c.counters[c.order[d-1]]<e?!0:!1)for(;0!==d&&c.counters[c.order[d-1]]<=e;)i=c.order[d-1],c.order[d]=i,c.order[d-1]=b,c.indices[i]=d,d-=1;else for(;d!==c.order.length-1&&c.counters[c.order[d+1]]>e;)i=c.order[d+1],c.order[d]=i,c.order[d+1]=b,c.indices[i]=d,d+=1;c.indices[b]=d},c=function(a,b){var c,d,f,g,h=[],i=a.state;if(0===i.order.length||0>=b)return h;for(d=0;b>d;d+=1)for(c=e(0,i.countersSum),g=0,f=0;f<i.order.length;f+=1)if(g+=i.counters[i.order[f]],g>c){h.push(i.order[f]);break}return h},d=function(a,b){var c,d,e,g,h,i=[],j=a.state;if(0===j.order.length||0>=b)return i;for(c=f(b,0,j.countersSum),d=0,e=j.counters[j.order[d]],g=0;b>g;g+=1)if(h=c[g],e>h)i.push(j.order[d]);else{do d+=1,e+=j.counters[j.order[d]];while(h>=e);i.push(j.order[d])}return i},h={name:"NotAnArrayException",message:"Parameter is required to be an array"},i=function(a){this.state={counters:{},countersSum:0,memorySize:1/0,order:[],indices:{}},this.memorySize(a)};return a.create=function(a){return new i(a)},i.prototype.prob=function(a){var b,c,d,e=[],f=this.state;if("string"==typeof a)throw h;for("undefined"==typeof a&&(a=f.order),b=0;b<a.length;b+=1)c=a[b],f.counters.hasOwnProperty(c)?(d=f.counters[c]/f.countersSum,e.push(d)):e.push(0);return e},i.prototype.head=function(a){var b=this.state;return"number"!=typeof a&&(a=0),a=Math.min(a,b.order.length),a>0?b.order.slice(0,a):0===a?b.order.slice(0):[]},i.prototype.peak=function(a){var b,c,d,e=this.state;if(0===e.order.length)return[];for(c=e.counters[e.order[0]],d=c-c*a,b=1;b<e.order.length&&!(d>e.counters[e.order[b]]);b+=1);return e.order.slice(0,b)},i.prototype.subset=function(a){var b,c,d,e,f=this.state;for(d=new i(f.memorySize),e=d.state,b=0;b<a.length;b+=1)c=a[b],f.counters.hasOwnProperty(c)&&(e.counters[c]=f.counters[c],e.countersSum+=f.counters[c]);for(b=0;b<f.order.length;b+=1)c=f.order[b],e.counters.hasOwnProperty(c)&&(e.order.push(c),e.indices[c]=e.order.length-1);return d},i.prototype.rank=function(a){var b,c,d=[],e=this.state;if("string"==typeof a)throw h;for("undefined"==typeof a&&(a=e.order),b=0;b<a.length;b+=1)c=a[b],d.push(e.indices.hasOwnProperty(c)?e.indices[c]:1/0);return d},i.prototype.each=function(a,b){var c,d,e,f,g=this.state,h=g.order.length;for(c=0;h>c;c+=1)d=g.order[c],e=g.counters[d]/g.countersSum,f=g.indices[d],a.call(b,d,e,f);return this},i.prototype.map=function(a,b){var c=[];return this.each(function(d,e,f){c.push(a.call(b,d,e,f))}),c},i.prototype.sample=function(a,b){var e,f,h=this.state;return"number"!=typeof a&&(a=1),"boolean"!=typeof b&&(b=!1),b?f=d(this,a):(e=h.order.length>30,f=e?g(d(this,a)):c(this,a)),f},i.prototype.size=function(){return this.state.countersSum},i.prototype.numCategories=function(){return this.state.order.length},i.prototype.dump=function(){var a,b,c,d=this.state,e=[];for(a=0;a<d.order.length;a+=1)b=d.order[a],c=d.counters[b],e.push(b),e.push(c);return e.push(1/0===d.memorySize?null:d.memorySize),e},i.prototype.copy=function(){var a=new i;return a.load(this.dump()),a},i.prototype.print=function(a){var b,c,d,e,f,g=this.state,h=0,i=g.order.length,j="";for("number"!=typeof a&&(a=2),a=Math.max(Math.min(a,10),0),e=this.prob(g.order),b=0;i>b;b+=1)c=g.order[b],h=Math.max(h,c.length);for(b=0;i>b;b+=1){for(c=g.order[b],d=e[b],f=c.length;h>f;f+=1)c+=" ";j+=c+" "+d.toFixed(a)+"\n"}return j},i.prototype.learn=function(a){var c,d,e=this.state;if(0===e.memorySize)return this;for(c=0;c<a.length;c+=1)e.countersSum+1>e.memorySize&&this.unlearn(this.sample()),d=a[c],e.counters.hasOwnProperty(d)?e.counters[d]+=1:(e.counters[d]=1,e.order.push(d),e.indices[d]=e.order.length-1),e.countersSum+=1,b(this,d);return this},i.prototype.unlearn=function(a){var c,d,e=this.state;for(c=0;c<a.length;c+=1)d=a[c],e.counters.hasOwnProperty(d)&&(e.counters[d]-=1,e.countersSum-=1,b(this,d),e.counters[d]<=0&&(e.order.pop(),delete e.counters[d],delete e.indices[d]));return this},i.prototype.memorySize=function(a){var b,c;if("undefined"==typeof a)return this.state.memorySize;if("number"!=typeof a&&(a=1/0),0>a&&(a=0),b=this.state.countersSum-a,b>0)for(c=0;c<Math.ceil(b);c+=1)this.unlearn(this.sample());this.state.memorySize=a},i.prototype.load=function(a){var b,c,d,e;for(e={counters:{},countersSum:0,memorySize:1/0,order:[],indices:{}},b=0;b+1<a.length;b+=2)c=a[b],d=a[b+1],e.counters[c]=d,e.countersSum+=d,e.order.push(c),e.indices[c]=e.order.length-1;return this.state=e,this.memorySize(a[b]),this},a}(),b.version="2.0.0",b.CategoricalDistribution.util=b.util,"object"==typeof module&&"object"==typeof module.exports?module.exports=b.CategoricalDistribution:a.CategoricalDistribution=b.CategoricalDistribution}(this);
//# sourceMappingURL=categorical-distribution.min.map